legend.key.width= unit(0.4, "cm"),
legend.margin =  margin(t = 0, r = 0, b = 0, l = -0.2, "cm"),
legend.text = element_text(size = 6),
legend.text.align = 0,
# legend.box.background = element_rect(),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, scales = "free", space = "free")
png(filename = paste0("output/_ComprehnsivePlots/", filename, ".png"), width = 6, height = 6, units = "in", res = 800)
multiplot(gg_dist, gg_mean, gg_stimfluct,
gg_corr, gg_varNorm, gg_fluct,
cols = 2)
dev.off()
gg_corr
# Plot
gg_corr <- ggplot() +
# geom_hline(data = taskCorrTot,
#            aes(yintercept = 0),
#            colour = "grey30") +
geom_point(data = taskCorrTot,
aes(x = n, y = TaskMean, fill = Source, colour = Source),
size = 1,
stroke = 0,
position = position_dodge(width = 2),
alpha = 0.4) +
theme_classic() +
labs(x = "Group size",
y = "Specialization") +
scale_x_continuous(breaks = unique(taskCorrTot$n)) +
scale_y_continuous(breaks = seq(-1, 1, 0.2)) +
scale_size_manual(values = c(2, 2, 2, 2, 2, 2, 2, -1, -1, 2)) +
scale_fill_manual(values = compPalette) +
scale_colour_manual(values = compPalette) +
theme(legend.position = "none",
axis.text = element_text(size = 8, colour = "black"),
axis.title = element_text(size = 10),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
# Mean and SE portion of plot
geom_errorbar(data = taskCorrMeans,
aes(x = n, ymin = SpecMean - SpecSE, ymax = SpecMean + SpecSE, colour = Source),
width = 5,
position = position_dodge(width = 1)) +
geom_point(data = taskCorrMeans,
aes(x = n, y = SpecMean, colour = Source, fill = Source, size = as.factor(n)),
position = position_dodge(width = 1)) +
geom_line(data = taskCorrMeans,
aes(x = n, y = SpecMean,  colour = Source),
position = position_dodge(width = 1)) +
facet_grid(. ~ mask, scales = "free", space = "free")
gg_corr
png(filename = paste0("output/_ComprehnsivePlots/", filename, ".png"), width = 6, height = 6, units = "in", res = 800)
multiplot(gg_dist, gg_mean, gg_stimfluct,
gg_corr, gg_varNorm, gg_fluct,
cols = 2)
dev.off()
# Plot
gg_stimfluct <- ggplot() +
geom_point(data = stimFluct,
aes(x = n, y = s1Fluct),
fill = "grey50",
colour = "grey50",
position = position_jitter(width = 0.1),
size = 0.7,
alpha = 0.4,
stroke = 0) +
geom_line(data = stimSumFluct,
aes(x = n, y = s1FluctMean),
size = 0) +
theme_classic() +
labs(x = "Group size",
y = "Stimulus fluctuation") +
scale_x_continuous(breaks = unique(stimFluct$n)) +
scale_y_continuous(breaks = seq(0, 2, 0.2),
limits = c(0, 0.85),
expand = c(0, 0)) +
scale_size_continuous(range = c(1.5, 1.5)) +
theme(legend.position = "none") +
# Mean and SE portion of plot
geom_errorbar(data = stimSumFluct,
aes(x = n,
ymin = s1FluctMean - s1FluctSE,
ymax = s1FluctMean + s1FluctSE),
colour = "black",
width = 3) +
geom_point(data = stimSumFluct,
aes(x = n, y = s1FluctMean, size = size),
colour = "black") +
theme(legend.position = "none",
legend.justification = c(1, 1),
legend.title = element_blank(),
legend.key.height = unit(0.3, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.margin =  margin(t = 0, r = 0, b = 0, l = -0.2, "cm"),
legend.text = element_text(size = 6),
legend.text.align = 0,
# legend.box.background = element_rect(),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, scales = "free", space = "free")
source('~/Documents/Research/Tarnita Lab/Incipient Groups DOL/DOLThresholdModel/scripts/other_scripts/3_SinglePlotResultsLargerSizes.R', echo=TRUE)
source('~/Documents/Research/Tarnita Lab/Incipient Groups DOL/DOLThresholdModel/scripts/other_scripts/3_SinglePlotResultsLargerSizes.R', echo=TRUE)
# Plot
gg_stimfluct <- ggplot() +
geom_point(data = stimFluct,
aes(x = n, y = s1Fluct),
fill = "grey50",
colour = "grey50",
position = position_jitter(width = 0.1),
size = 0.7,
alpha = 0.4,
stroke = 0) +
geom_line(data = stimSumFluct,
aes(x = n, y = s1FluctMean),
size = 0) +
theme_classic() +
labs(x = "Group size",
y = "Stimulus fluctuation") +
scale_x_continuous(breaks = unique(stimFluct$n)) +
scale_y_continuous(breaks = seq(0, 2, 0.2),
limits = c(0, 0.85),
expand = c(0, 0)) +
scale_size_continuous(range = c(1.5, 1.5)) +
theme(legend.position = "none") +
# Mean and SE portion of plot
geom_errorbar(data = stimSumFluct,
aes(x = n,
ymin = s1FluctMean - s1FluctSE,
ymax = s1FluctMean + s1FluctSE),
colour = "black",
width = 3) +
geom_point(data = stimSumFluct,
aes(x = n, y = s1FluctMean, size = size),
colour = "black") +
theme(legend.position = "none",
legend.justification = c(1, 1),
legend.title = element_blank(),
legend.key.height = unit(0.3, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.margin =  margin(t = 0, r = 0, b = 0, l = -0.2, "cm"),
legend.text = element_text(size = 6),
legend.text.align = 0,
# legend.box.background = element_rect(),
axis.text = element_text(size = 8),
axis.title.y = element_text(size = 10, margin = margin(0, 10, 0, 0)),
axis.title.x = element_text(size = 10),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, scales = "free", space = "free")
# MultiPlot
png(filename = paste0("output/_ComprehnsivePlots/", filename, ".png"), width = 6, height = 6, units = "in", res = 800)
multiplot(gg_dist, gg_mean, gg_stimfluct,
gg_corr, gg_varNorm, gg_fluct,
cols = 2)
dev.off()
# Plot
gg_stimfluct <- ggplot() +
geom_point(data = stimFluct,
aes(x = n, y = s1Fluct),
fill = "grey50",
colour = "grey50",
position = position_jitter(width = 0.1),
size = 0.7,
alpha = 0.4,
stroke = 0) +
geom_line(data = stimSumFluct,
aes(x = n, y = s1FluctMean),
size = 0) +
theme_classic() +
labs(x = "Group size",
y = "Stimulus fluctuation") +
scale_x_continuous(breaks = unique(stimFluct$n)) +
scale_y_continuous(breaks = seq(0, 2, 0.2),
limits = c(0, 0.85),
expand = c(0, 0)) +
scale_size_continuous(range = c(1.5, 1.5)) +
theme(legend.position = "none") +
# Mean and SE portion of plot
geom_errorbar(data = stimSumFluct,
aes(x = n,
ymin = s1FluctMean - s1FluctSE,
ymax = s1FluctMean + s1FluctSE),
colour = "black",
width = 3) +
geom_point(data = stimSumFluct,
aes(x = n, y = s1FluctMean, size = size),
colour = "black") +
theme(legend.position = "none",
legend.justification = c(1, 1),
legend.title = element_blank(),
legend.key.height = unit(0.3, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.margin =  margin(t = 0, r = 0, b = 0, l = -0.2, "cm"),
legend.text = element_text(size = 6),
legend.text.align = 0,
# legend.box.background = element_rect(),
axis.text = element_text(size = 8),
axis.title.y = element_text(size = 10, margin = margin(0, 11, 0, 0)),
axis.title.x = element_text(size = 10),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, scales = "free", space = "free")
png(filename = paste0("output/_ComprehnsivePlots/", filename, ".png"), width = 6, height = 6, units = "in", res = 800)
multiplot(gg_dist, gg_mean, gg_stimfluct,
gg_corr, gg_varNorm, gg_fluct,
cols = 2)
dev.off()
# Summarise by n
stimSumFluct <- stimFluct %>%
group_by(n, GroupSizeFactor) %>%
summarise(s1FluctMean = mean(s1Fluct, na.rm = TRUE),
s1FluctSE = sd(s1Fluct, na.rm = TRUE) / sqrt(length(s1Fluct)),
s2FluctMean = mean(s2Fluct, na.rm = TRUE),
s2FluctSE = sd(s2Fluct, na.rm = TRUE) / sqrt(length(s2Fluct)),
sFluctMean = mean(sFluct, na.rm = TRUE),
sFluctSE = sd(sFluct, na.rm = TRUE) / sqrt(length(sFluct)))
stimSumFluct <- as.data.frame(stimSumFluct)
stimSumFluct <- stimSumFluct %>%
mutate(GroupSizeFactor = factor(GroupSizeFactor, levels = sort(unique(n))))
addrows <- data.frame(n = c(37, 95, 102),
GroupSizeFactor = rep(NA, 2),
s1FluctMean = c(0.1220691, 0.0701031, 0.0701031),
s1FluctSE = c(NA, NA, NA),
s2FluctMean = c(NA, NA, NA),
s2FluctSE= c(NA, NA, NA),
sFluctMean = c(NA, NA, NA),
sFluctSE = c(NA, NA, NA))
stimSumFluct <- rbind(stimSumFluct, addrows)
stimSumFluct$mask <- 0
stimSumFluct$mask[stimSumFluct$n > 90] <- 1
stimFluct$mask <- 0
stimFluct$mask[stimFluct$n > 90] <- 1
stimSumFluct$size <- 1.5
stimSumFluct$size[stimSumFluct$n < 100 & stimSumFluct$n > 35] <- NA
stimSumFluct$size[stimSumFluct$n > 100] <- NA
# Plot
gg_stimfluct <- ggplot() +
geom_point(data = stimFluct,
aes(x = n, y = s1Fluct),
fill = "grey50",
colour = "grey50",
position = position_jitter(width = 0.1),
size = 0.7,
alpha = 0.4,
stroke = 0) +
geom_line(data = stimSumFluct,
aes(x = n, y = s1FluctMean),
size = 0) +
theme_classic() +
labs(x = "Group size",
y = "Stimulus fluctuation") +
scale_x_continuous(breaks = unique(stimFluct$n)) +
scale_y_continuous(breaks = seq(0, 2, 0.2),
limits = c(0, 0.85),
expand = c(0, 0)) +
scale_size_continuous(range = c(1.5, 1.5)) +
theme(legend.position = "none") +
# Mean and SE portion of plot
geom_errorbar(data = stimSumFluct,
aes(x = n,
ymin = s1FluctMean - s1FluctSE,
ymax = s1FluctMean + s1FluctSE),
colour = "black",
width = 2) +
geom_point(data = stimSumFluct,
aes(x = n, y = s1FluctMean, size = size),
colour = "black") +
theme(legend.position = "none",
legend.justification = c(1, 1),
legend.title = element_blank(),
legend.key.height = unit(0.3, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.margin =  margin(t = 0, r = 0, b = 0, l = -0.2, "cm"),
legend.text = element_text(size = 6),
legend.text.align = 0,
# legend.box.background = element_rect(),
axis.text = element_text(size = 8),
axis.title.y = element_text(size = 10, margin = margin(0, 11, 0, 0)),
axis.title.x = element_text(size = 10),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, scales = "free", space = "free")
####################
# Plot
####################
# MultiPlot
png(filename = paste0("output/_ComprehnsivePlots/", filename, ".png"), width = 6, height = 6, units = "in", res = 800)
multiplot(gg_dist, gg_mean, gg_stimfluct,
gg_corr, gg_varNorm, gg_fluct,
cols = 2)
dev.off()
gg_stimfluct
stimSumFluct
# Summarise by n
stimSumFluct <- stimFluct %>%
group_by(n, GroupSizeFactor) %>%
summarise(s1FluctMean = mean(s1Fluct, na.rm = TRUE),
s1FluctSE = sd(s1Fluct, na.rm = TRUE) / sqrt(length(s1Fluct)),
s2FluctMean = mean(s2Fluct, na.rm = TRUE),
s2FluctSE = sd(s2Fluct, na.rm = TRUE) / sqrt(length(s2Fluct)),
sFluctMean = mean(sFluct, na.rm = TRUE),
sFluctSE = sd(sFluct, na.rm = TRUE) / sqrt(length(sFluct)))
stimSumFluct <- as.data.frame(stimSumFluct)
stimSumFluct <- stimSumFluct %>%
mutate(GroupSizeFactor = factor(GroupSizeFactor, levels = sort(unique(n))))
addrows <- data.frame(n = c(37, 95, 102),
GroupSizeFactor = rep(NA, 2),
s1FluctMean = c(0.1220691, 0.0701031, 0.0701031),
s1FluctSE = c(NA, NA, NA),
s2FluctMean = c(NA, NA, NA),
s2FluctSE= c(NA, NA, NA),
sFluctMean = c(NA, NA, NA),
sFluctSE = c(NA, NA, NA))
addrows <- data.frame(n = c(37, 95, 102),
GroupSizeFactor = rep(NA, 3),
s1FluctMean = c(0.1220691, 0.0701031, 0.0701031),
s1FluctSE = c(NA, NA, NA),
s2FluctMean = c(NA, NA, NA),
s2FluctSE= c(NA, NA, NA),
sFluctMean = c(NA, NA, NA),
sFluctSE = c(NA, NA, NA))
stimSumFluct <- rbind(stimSumFluct, addrows)
stimSumFluct$mask <- 0
stimSumFluct$mask[stimSumFluct$n > 90] <- 1
stimFluct$mask <- 0
stimFluct$mask[stimFluct$n > 90] <- 1
stimSumFluct$size <- 1.5
stimSumFluct$size[stimSumFluct$n < 100 & stimSumFluct$n > 35] <- NA
stimSumFluct$size[stimSumFluct$n > 100] <- NA
# Plot
gg_stimfluct <- ggplot() +
geom_point(data = stimFluct,
aes(x = n, y = s1Fluct),
fill = "grey50",
colour = "grey50",
position = position_jitter(width = 0.1),
size = 0.7,
alpha = 0.4,
stroke = 0) +
geom_line(data = stimSumFluct,
aes(x = n, y = s1FluctMean),
size = 0) +
theme_classic() +
labs(x = "Group size",
y = "Stimulus fluctuation") +
scale_x_continuous(breaks = unique(stimFluct$n)) +
scale_y_continuous(breaks = seq(0, 2, 0.2),
limits = c(0, 0.85),
expand = c(0, 0)) +
scale_size_continuous(range = c(1.5, 1.5)) +
theme(legend.position = "none") +
# Mean and SE portion of plot
geom_errorbar(data = stimSumFluct,
aes(x = n,
ymin = s1FluctMean - s1FluctSE,
ymax = s1FluctMean + s1FluctSE),
colour = "black",
width = 2) +
geom_point(data = stimSumFluct,
aes(x = n, y = s1FluctMean, size = size),
colour = "black") +
theme(legend.position = "none",
legend.justification = c(1, 1),
legend.title = element_blank(),
legend.key.height = unit(0.3, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.margin =  margin(t = 0, r = 0, b = 0, l = -0.2, "cm"),
legend.text = element_text(size = 6),
legend.text.align = 0,
# legend.box.background = element_rect(),
axis.text = element_text(size = 8),
axis.title.y = element_text(size = 10, margin = margin(0, 11, 0, 0)),
axis.title.x = element_text(size = 10),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, scales = "free", space = "free")
####################
# Plot
####################
# MultiPlot
png(filename = paste0("output/_ComprehnsivePlots/", filename, ".png"), width = 6, height = 6, units = "in", res = 800)
multiplot(gg_dist, gg_mean, gg_stimfluct,
gg_corr, gg_varNorm, gg_fluct,
cols = 2)
dev.off()
# Summarise by n
tallySumFluct <- tallyFluct %>%
group_by(n, GroupSizeFactor) %>%
summarise(Task1FluctMean = mean(Task1Fluct, na.rm = TRUE),
Task1FluctSE = sd(Task1Fluct) / sqrt(length(Task1Fluct)),
Task2FluctMean = mean(Task2Fluct, na.rm = TRUE),
Task2FluctSE = sd(Task2Fluct, na.rm = TRUE) / sqrt(length(Task2Fluct)),
InactiveFluctMean = mean(InactiveFluct, na.rm = TRUE),
InactiveFluctSE = sd(InactiveFluct, na.rm = TRUE) / sqrt(length(InactiveFluct)))
tallySumFluct <- as.data.frame(tallySumFluct)
tallySumFluct <- tallySumFluct %>%
mutate(GroupSizeFactor = factor(GroupSizeFactor, levels = sort(unique(n))))
addrows <- data.frame(n = c(37, 95),
GroupSizeFactor = rep(NA, 3),
Task1FluctMean = c(0.04920449, 0.03104808, 0.03104808),
Task1FluctSE = c(NA, NA, NA),
Task2FluctMean = c(NA, NA, NA),
Task2FluctSE= c(NA, NA, NA),
InactiveFluctMean = c(NA, NA, NA),
InactiveFluctSE = c(NA, NA, NA))
tallySumFluct <- rbind(tallySumFluct, addrows)
tallySumFluct$mask <- 0
tallySumFluct$mask[stimSumFluct$n > 90] <- 1
tallyFluct$mask <- 0
tallyFluct$mask[tallyFluct$n > 90] <- 1
tallySumFluct$size <- 1.5
tallySumFluct$size[stimSumFluct$n < 100 & stimSumFluct$n > 35] <- NA
stimSumFluct$size[stimSumFluct$n > 100] <- NA
# Summarise by n
tallySumFluct <- tallyFluct %>%
group_by(n, GroupSizeFactor) %>%
summarise(Task1FluctMean = mean(Task1Fluct, na.rm = TRUE),
Task1FluctSE = sd(Task1Fluct) / sqrt(length(Task1Fluct)),
Task2FluctMean = mean(Task2Fluct, na.rm = TRUE),
Task2FluctSE = sd(Task2Fluct, na.rm = TRUE) / sqrt(length(Task2Fluct)),
InactiveFluctMean = mean(InactiveFluct, na.rm = TRUE),
InactiveFluctSE = sd(InactiveFluct, na.rm = TRUE) / sqrt(length(InactiveFluct)))
tallySumFluct <- as.data.frame(tallySumFluct)
tallySumFluct <- tallySumFluct %>%
mutate(GroupSizeFactor = factor(GroupSizeFactor, levels = sort(unique(n))))
addrows <- data.frame(n = c(37, 95, 102),
GroupSizeFactor = rep(NA, 3),
Task1FluctMean = c(0.04920449, 0.03104808, 0.03104808),
Task1FluctSE = c(NA, NA, NA),
Task2FluctMean = c(NA, NA, NA),
Task2FluctSE= c(NA, NA, NA),
InactiveFluctMean = c(NA, NA, NA),
InactiveFluctSE = c(NA, NA, NA))
tallySumFluct <- rbind(tallySumFluct, addrows)
tallySumFluct$mask <- 0
tallySumFluct$mask[stimSumFluct$n > 90] <- 1
tallyFluct$mask <- 0
tallyFluct$mask[tallyFluct$n > 90] <- 1
tallySumFluct$size <- 1.5
tallySumFluct$size[stimSumFluct$n < 100 & stimSumFluct$n > 35] <- NA
stimSumFluct$size[stimSumFluct$n > 100] <- NA
tallySumFluct$mask <- 0
tallySumFluct$mask[stimSumFluct$n > 90] <- 1
tallyFluct$mask <- 0
tallyFluct$mask[tallyFluct$n > 90] <- 1
tallySumFluct$size <- 1.5
tallySumFluct$size[tallySumFluct$n < 100 & tallySumFluct$n > 35] <- NA
tallySumFluct$size[tallySumFluct$n > 100] <- NA
# Plot
gg_fluct <- ggplot() +
geom_point(data = tallyFluct,
aes(x = n, y = Task1Fluct),
fill = "grey50",
colour = "grey50",
size = 0.7,
position = position_jitter(width = 0.1),
alpha = 0.4,
stroke = 0) +
theme_classic() +
labs(x = "Group size",
y = "Task fluctuation") +
scale_x_continuous(breaks = unique(tallyFluct$n)) +
scale_y_continuous(breaks = seq(0, 0.22, 0.02),
limits = c(0, 0.155),
expand = c(0, 0)) +
scale_size_continuous(range = c(1.5, 1.5)) +
theme(legend.position = "none") +
# Mean and SE portion of plot
geom_errorbar(data = tallySumFluct,
aes(x = n,
ymin = Task1FluctMean - Task1FluctSE,
ymax = Task1FluctMean + Task1FluctSE),
colour= "black",
width = 2) +
geom_point(data = tallySumFluct,
aes(x = n, y = Task1FluctMean, size = size),
colour = "black") +
theme(legend.position = "none",
legend.justification = c(1, 1),
legend.title = element_blank(),
legend.key.height = unit(0.3, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.margin =  margin(t = 0, r = 0, b = 0, l = -0.2, "cm"),
legend.text = element_text(size = 6),
legend.text.align = 0,
# legend.box.background = element_rect(),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm"))  +
facet_grid(. ~ mask, scales = "free", space = "free")
####################
# Plot
####################
# MultiPlot
png(filename = paste0("output/_ComprehnsivePlots/", filename, ".png"), width = 6, height = 6, units = "in", res = 800)
multiplot(gg_dist, gg_mean, gg_stimfluct,
gg_corr, gg_varNorm, gg_fluct,
cols = 2)
dev.off()
