# Graph
gg_relslope <- ggplot() +
geom_raster(data = improve06,
aes(x = sigma,
y = threshSlope,
fill = relativeSlope)) +
stat_contour(data = spec.fit,
aes(x = sigma,
y = threshSlope,
z = spec),
size = 0.3,
alpha = 1,
colour = "black",
breaks = c(-0.1,  0.1)) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Fit to Data",
colors = colPal,
#values = rescale(x = c(0, 0.01, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.5, 0.6)),
breaks = seq(-0.5, 0.5, 0.25),
colours = colPal,
limits = c(-0.5, 0.5),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "none",
legend.justification = c(1, 1),
legend.background = element_rect(color = "black", size = 0.2, linetype = "solid"),
legend.title = element_text(size = 4, face = "bold"),
legend.key.size = unit(0.15, "cm"),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 3),
title = element_text(size = 4),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10))
##### N = 2 #####
# Fit surface
spec.loess <- loess(relativeSmall ~ sigma * threshSlope, data = improve06, degree = 2, span = 0.1)
spec.fit <- expand.grid(list(sigma = seq(0, max(improve06$sigma), (max(improve06$sigma) - min(improve06$sigma)) / 1000),
threshSlope = seq(1, max(improve06$threshSlope), (max(improve06$threshSlope) - min(improve06$threshSlope)) / 1000)))
z <- predict(spec.loess, newdata = spec.fit)
spec.fit$spec <- as.numeric(z)
# Graph
gg_small <- ggplot() +
geom_raster(data = improve06,
aes(x = sigma,
y = threshSlope,
fill = relativeSmall)) +
stat_contour(data = spec.fit,
aes(x = sigma,
y = threshSlope,
z = spec),
size = 0.3,
alpha = 1,
colour = "black",
breaks = c(-0.1,  0.1)) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Fit to Data",
colors = colPal,
#values = rescale(x = c(0, 0.01, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.5, 0.6)),
breaks = seq(-0.5, 0.5, 0.25),
colours = colPal,
limits = c(-0.5, 0.5),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "none",
legend.justification = c(1, 1),
legend.background = element_rect(color = "black", size = 0.2, linetype = "solid"),
legend.title = element_text(size = 4, face = "bold"),
legend.key.size = unit(0.15, "cm"),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 3),
title = element_text(size = 4),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10))
##### N = 16 #####
# Fit surface
spec.loess <- loess(relativeLarge ~ sigma * threshSlope, data = improve06, degree = 2, span = 0.1)
spec.fit <- expand.grid(list(sigma = seq(0, max(improve06$sigma), (max(improve06$sigma) - min(improve06$sigma)) / 1000),
threshSlope = seq(1, max(improve06$threshSlope), (max(improve06$threshSlope) - min(improve06$threshSlope)) / 1000)))
z <- predict(spec.loess, newdata = spec.fit)
spec.fit$spec <- as.numeric(z)
# Graph
gg_large <- ggplot() +
geom_raster(data = improve06,
aes(x = sigma,
y = threshSlope,
fill = relativeLarge)) +
stat_contour(data = spec.fit,
aes(x = sigma,
y = threshSlope,
z = spec),
size = 0.3,
alpha = 1,
colour = "black",
breaks = c(-0.1,  0.1)) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Fit to Data",
colors = colPal,
#values = rescale(x = c(0, 0.01, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.5, 0.6)),
breaks = seq(-0.5, 0.5, 0.25),
colours = colPal,
limits = c(-0.5, 0.5),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
# legend.justification = c(1, 1),
legend.background = element_rect(color = "black", size = 0.2, linetype = "solid"),
legend.title = element_text(size = 4, face = "bold"),
legend.key.size = unit(0.15, "cm"),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 3),
title = element_text(size = 4),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10))
multiplot(gg_relslope, gg_small, gg_large, cols = 3)
gg_large <- ggplot() +
geom_raster(data = improve06,
aes(x = sigma,
y = threshSlope,
fill = relativeLarge)) +
stat_contour(data = spec.fit,
aes(x = sigma,
y = threshSlope,
z = spec),
size = 0.3,
alpha = 1,
colour = "black",
breaks = c(-0.1,  0.1)) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Fit to Data",
colors = colPal,
#values = rescale(x = c(0, 0.01, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.5, 0.6)),
breaks = seq(-0.5, 0.5, 0.25),
colours = colPal,
limits = c(-0.5, 0.5),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "none",
# legend.justification = c(1, 1),
legend.background = element_rect(color = "black", size = 0.2, linetype = "solid"),
legend.title = element_text(size = 4, face = "bold"),
legend.key.size = unit(0.15, "cm"),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 3),
title = element_text(size = 4),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10))
multiplot(gg_relslope, gg_small, gg_large, cols = 3)
gg_fit <- ggplot(spec.fit, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_tile() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(0, 2, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Overall\nFit",
colors = colPal,
#values = c(0, 0.5, 1),
breaks = c(0, 0.25, 0.5, 0.75, 1),
labels = c("Best", 0.25, 0.5, 0.75, "Worst"),
colours = colPal,
limits = c(0, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_fit
names(improve06)
gg_fit <- ggplot(improve06, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_tile() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(0, 2, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Overall\nFit",
colors = colPal,
#values = c(0, 0.5, 1),
breaks = c(0, 0.25, 0.5, 0.75, 1),
labels = c("Best", 0.25, 0.5, 0.75, "Worst"),
colours = colPal,
limits = c(0, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_fit
myPalette <- colorRampPalette((brewer.pal(9, "BuPu")))
colPal <- c("#ffffff", myPalette(9))
# Graph
gg_fit <- ggplot(improve06, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_tile() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(0, 2, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Overall\nFit",
colors = colPal,
#values = c(0, 0.5, 1),
breaks = c(0, 0.25, 0.5, 0.75, 1),
labels = c("Best", 0.25, 0.5, 0.75, "Worst"),
colours = colPal,
limits = c(0, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_fit
gg_fit08 <- ggplot(improve08, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_tile() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(0, 2, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Overall\nFit",
colors = colPal,
#values = c(0, 0.5, 1),
breaks = c(0, 0.25, 0.5, 0.75, 1),
labels = c("Best", 0.25, 0.5, 0.75, "Worst"),
colours = colPal,
limits = c(0, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_fit08
diff_improve <- improve08
diff_improve <- improve08 %>%
arrange(sigma, threshSlope)
View(diff_improve)
improve06 <- improve06 %>%
arrange(sigma, threshSlope)
diff_improve$fit <- diff_improve$fit - improve06$fit
View(diff_improve)
gg_fit08 <- ggplot(improve08, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_raster() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(0, 2, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Overall\nFit",
colors = colPal,
#values = c(0, 0.5, 1),
breaks = c(0, 0.25, 0.5, 0.75, 1),
labels = c("Best", 0.25, 0.5, 0.75, "Worst"),
colours = colPal,
limits = c(0, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_fit08
gg_fit06 <- ggplot(improve06, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_raster() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(0, 2, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Overall\nFit",
colors = colPal,
#values = c(0, 0.5, 1),
breaks = c(0, 0.25, 0.5, 0.75, 1),
labels = c("Best", 0.25, 0.5, 0.75, "Worst"),
colours = colPal,
limits = c(0, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_fit06
gg_fit06 <- ggplot(improve06, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_raster() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Overall\nFit",
colors = colPal,
#values = c(0, 0.5, 1),
breaks = c(0, 0.25, 0.5, 0.75, 1),
labels = c("Best", 0.25, 0.5, 0.75, "Worst"),
colours = colPal,
limits = c(0, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_fit06
gg_fit08 <- ggplot(improve08, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_raster() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Overall\nFit",
colors = colPal,
#values = c(0, 0.5, 1),
breaks = c(0, 0.25, 0.5, 0.75, 1),
labels = c("Best", 0.25, 0.5, 0.75, "Worst"),
colours = colPal,
limits = c(0, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_fit08
diff_improve <- improve08 %>%
arrange(sigma, threshSlope)
improve06 <- improve06 %>%
arrange(sigma, threshSlope)
diff_improve$fit <- diff_improve$fit - improve06$fit
gg_diff <- ggplot(diff_improve, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_raster() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradient2(name = "Change\nin Fit",
low = "#4d9221",
mid = "white",
high = "#c51b7d",
midpoint = 0,
limits = c(-0.5, 0.5),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_diff
gg_fit08 <- ggplot(improve08, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_raster() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Overall\nFit",
colors = colPal,
#values = c(0, 0.5, 1),
breaks = c(0, 0.25, 0.5, 0.75, 1),
labels = c("Best", 0.25, 0.5, 0.75, "Worst"),
colours = colPal,
limits = c(0, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_fit08
gg_small <- ggplot() +
geom_raster(data = improve06,
aes(x = sigma,
y = threshSlope,
fill = relativeSmall)) +
stat_contour(data = spec.fit,
aes(x = sigma,
y = threshSlope,
z = spec),
size = 0.3,
alpha = 1,
colour = "black",
breaks = c(-0.1,  0.1)) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Fit to Data",
colors = colPal,
#values = rescale(x = c(0, 0.01, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.5, 0.6)),
breaks = seq(-0.5, 0.5, 0.25),
colours = colPal,
limits = c(-0.5, 0.5),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "none",
legend.justification = c(1, 1),
legend.background = element_rect(color = "black", size = 0.2, linetype = "solid"),
legend.title = element_text(size = 4, face = "bold"),
legend.key.size = unit(0.15, "cm"),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 3),
title = element_text(size = 4),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10))
gg_small
diff_improve <- improve08 %>%
arrange(sigma, threshSlope)
improve06 <- improve06 %>%
arrange(sigma, threshSlope)
diff_improve$fit <- diff_improve$fit - improve06$fit
gg_diff <- ggplot(diff_improve, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_raster() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradient2(name = "Change\nin Fit",
low = "#4d9221",
mid = "white",
high = "#c51b7d",
midpoint = 0,
limits = c(-0.5, 0.5),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_diff
