alpha = 1,
colour = "black",
breaks = c(-0.1,  0.1)) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Fit to Data",
colors = colPal,
#values = rescale(x = c(0, 0.01, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.5, 0.6)),
breaks = seq(-1, 1, 0.5),
colours = colPal,
limits = c(-1, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 7),
legend.key.height = unit(0.3, "cm"),
legend.key.width= unit(0.2, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 6),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
png("output/ParameterExploration/Plot/Delta06_SlopeandSizeWithLegend.png", width = 6, height = 2, units = "in", res = 800)
multiplot(gg_relslope, gg_small, gg_large, cols = 3)
dev.off()
gg_large <- ggplot() +
geom_raster(data = improve06,
aes(x = sigma,
y = threshSlope,
fill = relativeLarge)) +
stat_contour(data = spec.fit,
aes(x = sigma,
y = threshSlope,
z = spec),
size = 0.3,
alpha = 1,
colour = "black",
breaks = c(-0.1,  0.1)) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Fit to Data",
colors = colPal,
#values = rescale(x = c(0, 0.01, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.5, 0.6)),
breaks = seq(-1, 1, 0.5),
colours = colPal,
limits = c(-1, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 7),
legend.key.height = unit(0.3, "cm"),
legend.key.width= unit(0.3, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 6),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
png("output/ParameterExploration/Plot/Delta06_SlopeandSizeWithLegend.png", width = 6, height = 2, units = "in", res = 800)
multiplot(gg_relslope, gg_small, gg_large, cols = 3)
dev.off()
gg_large <- ggplot() +
geom_raster(data = improve06,
aes(x = sigma,
y = threshSlope,
fill = relativeLarge)) +
stat_contour(data = spec.fit,
aes(x = sigma,
y = threshSlope,
z = spec),
size = 0.3,
alpha = 1,
colour = "black",
breaks = c(-0.1,  0.1)) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Fit to Data",
colors = colPal,
#values = rescale(x = c(0, 0.01, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.5, 0.6)),
breaks = seq(-1, 1, 0.5),
colours = colPal,
limits = c(-1, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 7),
legend.key.height = unit(0.4, "cm"),
legend.key.width= unit(0.25, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 6),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
png("output/ParameterExploration/Plot/Delta06_SlopeandSizeWithLegend.png", width = 6, height = 2, units = "in", res = 800)
multiplot(gg_relslope, gg_small, gg_large, cols = 3)
dev.off()
gg_large <- ggplot() +
geom_raster(data = improve06,
aes(x = sigma,
y = threshSlope,
fill = relativeLarge)) +
stat_contour(data = spec.fit,
aes(x = sigma,
y = threshSlope,
z = spec),
size = 0.3,
alpha = 1,
colour = "black",
breaks = c(-0.1,  0.1)) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Fit to Data",
colors = colPal,
#values = rescale(x = c(0, 0.01, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.5, 0.6)),
breaks = seq(-1, 1, 0.5),
colours = colPal,
limits = c(-1, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.3, "cm"),
legend.key.width= unit(0.25, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 6),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
png("output/ParameterExploration/Plot/Delta06_SlopeandSizeWithLegend.png", width = 6, height = 2, units = "in", res = 800)
multiplot(gg_relslope, gg_small, gg_large, cols = 3)
dev.off()
gg_large <- ggplot() +
geom_raster(data = improve06,
aes(x = sigma,
y = threshSlope,
fill = relativeLarge)) +
stat_contour(data = spec.fit,
aes(x = sigma,
y = threshSlope,
z = spec),
size = 0.3,
alpha = 1,
colour = "black",
breaks = c(-0.1,  0.1)) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Fit to Data",
colors = colPal,
#values = rescale(x = c(0, 0.01, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.5, 0.6)),
breaks = seq(-1, 1, 0.5),
colours = colPal,
limits = c(-1, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.3, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
png("output/ParameterExploration/Plot/Delta06_SlopeandSizeWithLegend.png", width = 6, height = 2, units = "in", res = 800)
multiplot(gg_relslope, gg_small, gg_large, cols = 3)
dev.off()
gg_large <- ggplot() +
geom_raster(data = improve06,
aes(x = sigma,
y = threshSlope,
fill = relativeLarge)) +
stat_contour(data = spec.fit,
aes(x = sigma,
y = threshSlope,
z = spec),
size = 0.3,
alpha = 1,
colour = "black",
breaks = c(-0.1,  0.1)) +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Fit to Data",
colors = colPal,
#values = rescale(x = c(0, 0.01, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.5, 0.6)),
breaks = seq(-1, 1, 0.5),
colours = colPal,
limits = c(-1, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
png("output/ParameterExploration/Plot/Delta06_SlopeandSizeWithLegend.png", width = 6, height = 2, units = "in", res = 800)
multiplot(gg_relslope, gg_small, gg_large, cols = 3)
dev.off()
# Try custom color
myPalette <- colorRampPalette((brewer.pal(9, "BuPu")))
colPal <- c("#ffffff", myPalette(9))
# Graph
gg_fit06 <- ggplot(improve06, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_raster() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Overall\nFit",
colors = colPal,
#values = c(0, 0.5, 1),
breaks = c(0, 0.25, 0.5, 0.75, 1),
labels = c("Best", 0.25, 0.5, 0.75, "Worst"),
colours = colPal,
limits = c(0, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 7),
legend.key.height = unit(0.3, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 6),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_fit06
gg_fit08 <- ggplot(improve08, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_raster() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Overall\nFit",
colors = colPal,
#values = c(0, 0.5, 1),
breaks = c(0, 0.25, 0.5, 0.75, 1),
labels = c("Best", 0.25, 0.5, 0.75, "Worst"),
colours = colPal,
limits = c(0, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_fit08
##### Delta 08 #####
# load
load("output/ParameterExploration/Rdata/FixedDelta08_SigmaSlopeExplorationEXTRA.Rdata")
improve1 <- improve %>%
mutate(relativePercInc = (PercIncrease - 1.220554) / 1.220554,
relativeSlope   = (SlopeIncrease - 0.02322321) / 0.02322321,
relativeLarge   = (SpecLarge - 0.5915000) / 0.5915000,
relativeSmall   = (SpecSmall - 0.2663750) / 0.2663750,
Increase        = SlopeIncrease * 14) %>%
mutate(fit = (abs(relativeLarge) + abs(relativeSmall) + abs(relativeSlope)) / 3)
load("output/ParameterExploration/Rdata/FixedDelta08_SigmaSlopeExplorationEXTRA2.Rdata")
improve2 <- improve %>%
mutate(relativePercInc = (PercIncrease - 1.220554) / 1.220554,
relativeSlope   = (SlopeIncrease - 0.02322321) / 0.02322321,
relativeLarge   = (SpecLarge - 0.5915000) / 0.5915000,
relativeSmall   = (SpecSmall - 0.2663750) / 0.2663750,
Increase        = SlopeIncrease * 14) %>%
mutate(fit = (abs(relativeLarge) + abs(relativeSmall) + abs(relativeSlope)) / 3)
load("output/ParameterExploration/Rdata/FixedDelta08_SigmaSlopeExploration.Rdata")
improve <- improve %>%
mutate(relativePercInc = (PercIncrease - 1.220554) / 1.220554,
relativeSlope   = (SlopeIncrease - 0.02322321) / 0.02322321,
relativeLarge   = (SpecLarge - 0.5915000) / 0.5915000,
relativeSmall   = (SpecSmall - 0.2663750) / 0.2663750,
Increase        = SlopeIncrease * 14) %>%
mutate(fit = (abs(relativeLarge) + abs(relativeSmall) + abs(relativeSlope)) / 3)
improve08 <- rbind(improve, improve1, improve2)
rm(improve, improve1, improve2)
# Filter to size
improve08 <- improve08 %>%
filter(!sigma %in% c(0.075, 0.125, 0.175, 0.225, 0.275, 0.325))
#
# Graph
gg_fit08 <- ggplot(improve08, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_raster() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Overall\nFit",
colors = colPal,
#values = c(0, 0.5, 1),
breaks = c(0, 0.25, 0.5, 0.75, 1),
labels = c("Best", 0.25, 0.5, 0.75, "Worst"),
colours = colPal,
limits = c(0, 1),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_fit08
##### Change in Fit #####
diff_improve <- improve08 %>%
arrange(sigma, threshSlope)
improve06 <- improve06 %>%
arrange(sigma, threshSlope)
diff_improve$fit <- diff_improve$fit - improve06$fit
gg_diff <- ggplot(diff_improve, aes(x = sigma, y = threshSlope, fill = fit)) +
geom_raster() +
theme_bw() +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradient2(name = "Change\nin Fit",
low = "#4d9221",
mid = "white",
high = "#c51b7d",
midpoint = 0,
limits = c(-0.5, 0.5),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.key.height = unit(0.5, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0.1, r = 0.1, b = 0.1, l = 0.1, "cm"),
legend.text = element_text(size = 8),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
panel.border = element_rect(fill = NA, size = 1))
gg_diff
ggsave("output/ParameterExploration/Plot/Fixed_0806DifferenceOfFit.png", width = 2.75, height = 2, units = "in", dpi = 600)
gg_fit08
ggsave("output/ParameterExploration/Plot/Delta08_fit.png", width = 2.8, height = 2, units = "in", dpi = 600)
gg_fit06
gg_fit06
ggsave("output/ParameterExploration/Plot/Delta06_fit.png", width = 2.8, height = 2, units = "in", dpi = 600)
rm(list = ls())
source("scripts/__Util__MASTER.R")
library(scales)
library(RColorBrewer)
####################
# Prep and Plot
####################
##### Delta 06 #####
# load
load("output/ParameterExploration/Rdata/FixedDelta06_SigmaSlopeExplorationEXTRA.Rdata")
improve1 <- improve %>%
mutate(relativePercInc = (PercIncrease - 1.220554) / 1.220554,
relativeSlope   = (SlopeIncrease - 0.02322321) / 0.02322321,
relativeLarge   = (SpecLarge - 0.5915000) / 0.5915000,
relativeSmall   = (SpecSmall - 0.2663750) / 0.2663750,
Increase        = SlopeIncrease * 14) %>%
mutate(fit = (abs(relativeLarge) + abs(relativeSmall) + abs(relativeSlope)) / 3)
load("output/ParameterExploration/Rdata/FixedDelta06_SigmaSlopeExplorationEXTRA2.Rdata")
improve2 <- improve %>%
mutate(relativePercInc = (PercIncrease - 1.220554) / 1.220554,
relativeSlope   = (SlopeIncrease - 0.02322321) / 0.02322321,
relativeLarge   = (SpecLarge - 0.5915000) / 0.5915000,
relativeSmall   = (SpecSmall - 0.2663750) / 0.2663750,
Increase        = SlopeIncrease * 14) %>%
mutate(fit = (abs(relativeLarge) + abs(relativeSmall) + abs(relativeSlope)) / 3)
load("output/ParameterExploration/Rdata/FixedDelta06_SigmaSlopeExploration.Rdata")
improve <- improve %>%
mutate(relativePercInc = (PercIncrease - 1.220554) / 1.220554,
relativeSlope   = (SlopeIncrease - 0.02322321) / 0.02322321,
relativeLarge   = (SpecLarge - 0.5915000) / 0.5915000,
relativeSmall   = (SpecSmall - 0.2663750) / 0.2663750,
Increase        = SlopeIncrease * 14) %>%
mutate(fit = (abs(relativeLarge) + abs(relativeSmall) + abs(relativeSlope)) / 3)
improve06 <- rbind(improve, improve1, improve2)
rm(improve, improve1, improve2)
improve06 <- improve06 %>%
filter(!sigma %in% c(0.075, 0.125, 0.175, 0.225, 0.275, 0.325))
View(improve06)
22/1530
####################
# Parameter Space Exploration
####################
rm(list = ls())
source("scripts/__Util__MASTER.R")
library(RColorBrewer)
library(scales)
##### Delta 06 #####
# load
load("output/ParameterExploration/Rdata/FixedDelta06_SigmaSlopeExplorationEXTRA.Rdata")
improve1 <- improve %>%
mutate(relativePercInc = (PercIncrease - 1.220554) / 1.220554,
relativeSlope   = (SlopeIncrease - 0.02322321) / 0.02322321,
relativeLarge   = (SpecLarge - 0.5915000) / 0.5915000,
relativeSmall   = (SpecSmall - 0.2663750) / 0.2663750,
Increase        = SlopeIncrease * 14) %>%
mutate(fit = (abs(relativeLarge) + abs(relativeSmall) + abs(relativeSlope)) / 3)
load("output/ParameterExploration/Rdata/FixedDelta06_SigmaSlopeExplorationEXTRA2.Rdata")
improve2 <- improve %>%
mutate(relativePercInc = (PercIncrease - 1.220554) / 1.220554,
relativeSlope   = (SlopeIncrease - 0.02322321) / 0.02322321,
relativeLarge   = (SpecLarge - 0.5915000) / 0.5915000,
relativeSmall   = (SpecSmall - 0.2663750) / 0.2663750,
Increase        = SlopeIncrease * 14) %>%
mutate(fit = (abs(relativeLarge) + abs(relativeSmall) + abs(relativeSlope)) / 3)
load("output/ParameterExploration/Rdata/FixedDelta06_SigmaSlopeExploration.Rdata")
improve <- improve %>%
mutate(relativePercInc = (PercIncrease - 1.220554) / 1.220554,
relativeSlope   = (SlopeIncrease - 0.02322321) / 0.02322321,
relativeLarge   = (SpecLarge - 0.5915000) / 0.5915000,
relativeSmall   = (SpecSmall - 0.2663750) / 0.2663750,
Increase        = SlopeIncrease * 14) %>%
mutate(fit = (abs(relativeLarge) + abs(relativeSmall) + abs(relativeSlope)) / 3)
improve06 <- rbind(improve, improve1, improve2)
rm(improve, improve1, improve2)
# Filter to size
improve06 <- improve06 %>%
filter(!sigma %in% c(0.075, 0.125, 0.175, 0.225, 0.275, 0.325))
##### Absolute Slope #####
# Colors
myPalette <- colorRampPalette(brewer.pal(6, "YlOrRd"))
colPal <- c(myPalette(6), "#800026")
# Fit surface
spec.loess <- loess(Increase ~ sigma * threshSlope, data = improve06, degree = 2, span = 0.1)
spec.fit <- expand.grid(list(sigma = seq(0, max(improve06$sigma), (max(improve06$sigma) - min(improve06$sigma)) / 1000),
threshSlope = seq(1, max(improve06$threshSlope), (max(improve06$threshSlope) - min(improve06$threshSlope)) / 1000)))
z <- predict(spec.loess, newdata = spec.fit)
spec.fit$spec <- as.numeric(z)
# Graph
gg_abslope <- ggplot() +
geom_raster(data = improve06,
aes(x = sigma,
y = threshSlope,
fill = Increase)) +
stat_contour(data = spec.fit,
aes(x = sigma,
y = threshSlope,
z = spec),
size = 0.3,
alpha = 1,
colour = "white",
breaks = c(0.2926124,  0.3576374)) +
theme_bw() +
scale_x_continuous(expand = c(0.00, 0)) +
scale_y_continuous(expand = c(0.00, 0), breaks = c(1, seq(10, 30, 10))) +
scale_fill_gradientn(name = "Specialization\nIncrease",
colors = colPal,
breaks = seq(0, 0.5, 0.1),
colours = colPal,
limits = c(0, 0.5),
oob = squish) +
scale_colour_gradientn(name = "Specialization\nIncrease",
colors = colPal,
breaks = seq(0, 0.5, 0.1),
colours = colPal,
limits = c(0, 0.5),
oob = squish) +
xlab(expression(sigma)) +
ylab(expression(eta)) +
theme(legend.position = "none",
# legend.key.height = unit(0.84, "cm"),
legend.key.height = unit(0.17, "npc"),
legend.key.width= unit(0.2, "cm"),
legend.key = element_rect(colour = "black", size = 0.5),
legend.margin =  margin(t = 0, r = 0, b = 0, l = -0.2, "cm"),
legend.text = element_text(size = 6),
legend.title = element_blank(),
axis.text.y = element_text(size = 6, margin = margin(5, 2, 5, -2)),
axis.text.x = element_text(size = 6, margin = margin(2, 5, -2, 5)),
axis.title = element_text(size = 9),
axis.ticks.length = unit(0, "cm"),
panel.border = element_rect(fill = "NA", size = 1))
ggsave("output/MSFigures/ParameterSpaceDelta06.png", width = 2.7, height = 2, units = "in", dpi = 600)
