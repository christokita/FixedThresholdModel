taskVarMeans <- rbind(taskVarMeans, addrows)
taskVarMean$mask <- 0
taskVarMean$mask[taskVarMean$n > 90] <- 1
taskVarMeans$mask <- 0
taskVarMeans$mask[taskVarMeans$n > 90] <- 1
# Plot variance and mean by group size
gg_varNorm <- ggplot() +
geom_hline(data = taskVarMean,
aes(yintercept = 1),
colour = "grey30") +
geom_point(data = taskVarMean,
aes(x = n, y = NormVarMean, colour = Source),
size = 0.8,
alpha = 0.4,
position = position_dodge(width = 1)) +
theme_classic() +
xlab("Group Size") +
ylab("Behavioral Variation (SD)\nRelative to Group Size 16") +
scale_x_continuous(breaks = unique(taskVarMean$n)) +
scale_y_continuous(breaks = seq(0, 3, 0.5)) +
scale_size_manual(values = c(2, 2, 2, 2, 2, 2, 2, 2, -1, -1, 2)) +
# Mean and SE portion of plot
geom_errorbar(data = taskVarMeans,
aes(x = n, ymin = NormVarMean - NormVarMeanSE, ymax = NormVarMean + NormVarMeanSE, colour = Source, width = 1.5),
position = position_dodge(width = 1)) +
geom_point(data = taskVarMeans,
aes(x = n, y = NormVarMean, colour = Source, size = as.factor(n)),
position = position_dodge(width = 1)) +
geom_line(data = taskVarMeans,
aes(x = n, y = NormVarMean, colour = Source),
position = position_dodge(width = 1)) +
scale_fill_manual(values = compPalette) +
scale_colour_manual(values = compPalette) +
theme(legend.position = "none",
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, space = "free", scale = "free")
gg_varNorm
gg_varNorm <- ggplot() +
geom_hline(data = taskVarMean,
aes(yintercept = 1),
colour = "grey30") +
geom_point(data = taskVarMean,
aes(x = n, y = NormVarMean, colour = Source),
size = 0.8,
alpha = 0.4,
position = position_dodge(width = 1)) +
theme_classic() +
xlab("Group Size") +
ylab("Behavioral Variation (SD)\nRelative to Group Size 16") +
scale_x_continuous(breaks = unique(taskVarMean$n)) +
scale_y_continuous(breaks = seq(0, 3, 0.5)) +
scale_size_manual(values = c(2, 2, 2, 2, 2, 2, 2, 2, -1, -1, 2)) +
# Mean and SE portion of plot
geom_errorbar(data = taskVarMeans,
aes(x = n, ymin = NormVarMean - NormVarMeanSE, ymax = NormVarMean + NormVarMeanSE, colour = Source, width = 1.5),
position = position_dodge(width = 1)) +
geom_point(data = taskVarMeans,
aes(x = n, y = NormVarMean, colour = Source, size = as.factor(n)),
position = position_dodge(width = 1)) +
geom_line(data = taskVarMeans,
aes(x = n, y = NormVarMean, colour = Source),
position = position_dodge(width = 1)) +
scale_fill_manual(values = compPalette) +
scale_colour_manual(values = compPalette) +
theme(legend.position = "none",
axis.text = element_text(size = 8),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, space = "free", scale = "free")
gg_varNorm
gg_varNorm <- ggplot() +
geom_hline(data = taskVarMean,
aes(yintercept = 1),
colour = "grey30") +
geom_point(data = taskVarMean,
aes(x = n, y = NormVarMean, colour = Source),
size = 0.8,
alpha = 0.4,
position = position_dodge(width = 1)) +
theme_classic() +
xlab("Group Size") +
ylab("Relative task 1 variation") +
scale_x_continuous(breaks = unique(taskVarMean$n)) +
scale_y_continuous(breaks = seq(0, 3, 0.5)) +
scale_size_manual(values = c(2, 2, 2, 2, 2, 2, 2, 2, -1, -1, 2)) +
# Mean and SE portion of plot
geom_errorbar(data = taskVarMeans,
aes(x = n, ymin = NormVarMean - NormVarMeanSE, ymax = NormVarMean + NormVarMeanSE, colour = Source, width = 1.5),
position = position_dodge(width = 1)) +
geom_point(data = taskVarMeans,
aes(x = n, y = NormVarMean, colour = Source, size = as.factor(n)),
position = position_dodge(width = 1)) +
geom_line(data = taskVarMeans,
aes(x = n, y = NormVarMean, colour = Source),
position = position_dodge(width = 1)) +
scale_fill_manual(values = compPalette) +
scale_colour_manual(values = compPalette) +
theme(legend.position = "none",
axis.text = element_text(size = 8),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, space = "free", scale = "free")
gg_mean <- ggplot() +
geom_hline(data = taskVarMean,
aes(yintercept = 1),
colour = "grey30") +
geom_point(data = taskVarMean,
aes(x = n, y = NormMean, colour = Source),
size = 0.5,
alpha = 0.4,
position = position_dodge(width = 1)) +
theme_classic() +
xlab("Group Size") +
ylab("Relative task 1 frequency") +
scale_x_continuous(breaks = unique(taskVarMean$n)) +
scale_y_continuous(breaks = seq(0, 1.5, 0.05)) +
scale_size_manual(values = c(2, 2, 2, 2, 2, 2, 2, 2, -1, -1, 2)) +
# Mean and SE portion of plot
geom_errorbar(data = taskVarMeans,
aes(x = n, ymin = NormMean - NormMeanSE, ymax = NormMean + NormMeanSE, colour = Source, width = 1.5),
position = position_dodge(width = 1)) +
geom_point(data = taskVarMeans,
aes(x = n, y = NormMean, colour = Source, size = as.factor(n)),
position = position_dodge(width = 1)) +
geom_line(data = taskVarMeans,
aes(x = n, y = NormMean, colour = Source),
position = position_dodge(width = 1)) +
scale_fill_manual(values = compPalette) +
scale_colour_manual(values = compPalette) +
theme(legend.position = "none",
axis.text = element_text(size = 8),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, space = "free", scale = "free")
gg_mean
gg_corr <- ggplot() +
geom_hline(data = taskCorrTot,
aes(yintercept = 0),
colour = "grey30") +
geom_point(data = taskCorrTot,
aes(x = n, y = TaskMean, fill = Source, colour = Source),
size = 0.5,
position = position_dodge(width = 1),
alpha = 0.4) +
theme_classic() +
labs(x = "Group Size",
y = "Specialization") +
scale_x_continuous(breaks = unique(taskCorrTot$n)) +
scale_y_continuous(breaks = seq(-1, 1, 0.2)) +
scale_size_manual(values = c(2, 2, 2, 2, 2, 2, 2, -1, -1, 2)) +
scale_fill_manual(values = compPalette) +
scale_colour_manual(values = compPalette) +
theme(legend.position = "none",
axis.text = element_text(size = 8),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
# Mean and SE portion of plot
geom_errorbar(data = taskCorrMeans,
aes(x = n, ymin = SpecMean - SpecSE, ymax = SpecMean + SpecSE, colour = Source, width = 1.5),
position = position_dodge(width = 1)) +
geom_point(data = taskCorrMeans,
aes(x = n, y = SpecMean, colour = Source, fill = Source, size = as.factor(n)),
position = position_dodge(width = 1)) +
geom_line(data = taskCorrMeans,
aes(x = n, y = SpecMean,  colour = Source),
position = position_dodge(width = 1)) +
facet_grid(. ~ mask, scales = "free", space = "free")
# Unlist
taskCorrTot <- do.call("rbind", groups_taskCorr)
taskCorrTot <- taskCorrTot %>%
mutate(TaskMean = (Task1 + Task2) / 2)
# Manipulate and bind with Yuko data
taskCorrTot <- taskCorrTot %>%
mutate(Source = "Model") %>%
select(n, TaskMean, Source) %>%
rbind(yukoCorr) %>%
mutate(Source = as.factor(Source))
taskCorrTot <- as.data.frame(taskCorrTot)
# Calculate means and SE
taskCorrMeans <- taskCorrTot %>%
group_by(Source, n) %>%
summarise(SpecMean = mean(TaskMean),
SpecSE = sd(TaskMean) / sqrt(length(TaskMean)),
SpecCI = 1.96 * SpecSE)
# Set for broken axis
addrows <- data.frame(Source = rep("Model", 2),
n = c(37, 95),
SpecMean = c(0.6673539, 0.6885347),
SpecSE = c(NA, NA),
SpecCI = c(NA, NA))
taskCorrMeans <- as.data.frame(taskCorrMeans)
taskCorrMeans <- rbind(taskCorrMeans, addrows)
taskCorrMeans$mask <- 0
taskCorrMeans$mask[taskCorrMeans$n > 90] <- 1
taskCorrTot$mask <- 0
taskCorrTot$mask[taskCorrTot$n > 90] <- 1
# Plot
gg_corr <- ggplot() +
geom_hline(data = taskCorrTot,
aes(yintercept = 0),
colour = "grey30") +
geom_point(data = taskCorrTot,
aes(x = n, y = TaskMean, fill = Source, colour = Source),
size = 0.5,
position = position_dodge(width = 1),
alpha = 0.4) +
theme_classic() +
labs(x = "Group Size",
y = "Specialization") +
scale_x_continuous(breaks = unique(taskCorrTot$n)) +
scale_y_continuous(breaks = seq(-1, 1, 0.2)) +
scale_size_manual(values = c(2, 2, 2, 2, 2, 2, 2, -1, -1, 2)) +
scale_fill_manual(values = compPalette) +
scale_colour_manual(values = compPalette) +
theme(legend.position = "none",
axis.text = element_text(size = 8),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
# Mean and SE portion of plot
geom_errorbar(data = taskCorrMeans,
aes(x = n, ymin = SpecMean - SpecSE, ymax = SpecMean + SpecSE, colour = Source, width = 1.5),
position = position_dodge(width = 1)) +
geom_point(data = taskCorrMeans,
aes(x = n, y = SpecMean, colour = Source, fill = Source, size = as.factor(n)),
position = position_dodge(width = 1)) +
geom_line(data = taskCorrMeans,
aes(x = n, y = SpecMean,  colour = Source),
position = position_dodge(width = 1)) +
facet_grid(. ~ mask, scales = "free", space = "free")
multiplot(gg_dist, gg_mean,  gg_corr, gg_varNorm, cols = 2)
# MultiPlot
png(filename = paste0("output/_ComprehnsivePlots/", filename, ".png"), width = 4, height = 4, units = "in", res = 800)
multiplot(gg_dist, gg_mean,  gg_corr, gg_varNorm, cols = 2)
dev.off()
gg_corr <- ggplot() +
geom_hline(data = taskCorrTot,
aes(yintercept = 0),
colour = "grey30") +
geom_point(data = taskCorrTot,
aes(x = n, y = TaskMean, fill = Source, colour = Source),
size = 0.5,
position = position_dodge(width = 1),
alpha = 0.4) +
theme_classic() +
labs(x = "Group Size",
y = "Specialization") +
scale_x_continuous(breaks = unique(taskCorrTot$n)) +
scale_y_continuous(breaks = seq(-1, 1, 0.2)) +
scale_size_manual(values = c(2, 2, 2, 2, 2, 2, 2, -1, -1, 2)) +
scale_fill_manual(values = compPalette) +
scale_colour_manual(values = compPalette) +
theme(legend.position = "none",
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 6),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
# Mean and SE portion of plot
geom_errorbar(data = taskCorrMeans,
aes(x = n, ymin = SpecMean - SpecSE, ymax = SpecMean + SpecSE, colour = Source, width = 1.5),
position = position_dodge(width = 1)) +
geom_point(data = taskCorrMeans,
aes(x = n, y = SpecMean, colour = Source, fill = Source, size = as.factor(n)),
position = position_dodge(width = 1)) +
geom_line(data = taskCorrMeans,
aes(x = n, y = SpecMean,  colour = Source),
position = position_dodge(width = 1)) +
facet_grid(. ~ mask, scales = "free", space = "free")
gg_dist <- ggplot(data = plot_TaskMat, aes(y = Task1, x = set)) +
geom_point(aes(colour = n), size = 0.3) +
theme_classic() +
labs(x = "Group size",
y = "Task 1 frequency") +
scale_color_manual(values = palette) +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.2)) +
theme(axis.text.x = element_text(size = 0),
axis.ticks.x = element_blank(),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10, margin = margin(0, 0, 0, 0)),
axis.title.x = element_text(size = 10, margin = margin(12, 0, 0, 0)),
legend.position = "none")
gg_mean <- ggplot() +
geom_hline(data = taskVarMean,
aes(yintercept = 1),
colour = "grey30") +
geom_point(data = taskVarMean,
aes(x = n, y = NormMean, colour = Source),
size = 0.5,
alpha = 0.4,
position = position_dodge(width = 1)) +
theme_classic() +
xlab("Group Size") +
ylab("Relative task 1 frequency") +
scale_x_continuous(breaks = unique(taskVarMean$n)) +
scale_y_continuous(breaks = seq(0, 1.5, 0.05)) +
scale_size_manual(values = c(2, 2, 2, 2, 2, 2, 2, 2, -1, -1, 2)) +
# Mean and SE portion of plot
geom_errorbar(data = taskVarMeans,
aes(x = n, ymin = NormMean - NormMeanSE, ymax = NormMean + NormMeanSE, colour = Source, width = 1.5),
position = position_dodge(width = 1)) +
geom_point(data = taskVarMeans,
aes(x = n, y = NormMean, colour = Source, size = as.factor(n)),
position = position_dodge(width = 1)) +
geom_line(data = taskVarMeans,
aes(x = n, y = NormMean, colour = Source),
position = position_dodge(width = 1)) +
scale_fill_manual(values = compPalette) +
scale_colour_manual(values = compPalette) +
theme(legend.position = "none",
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 6),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, space = "free", scale = "free")
gg_varNorm <- ggplot() +
geom_hline(data = taskVarMean,
aes(yintercept = 1),
colour = "grey30") +
geom_point(data = taskVarMean,
aes(x = n, y = NormVarMean, colour = Source),
size = 0.8,
alpha = 0.4,
position = position_dodge(width = 1)) +
theme_classic() +
xlab("Group Size") +
ylab("Relative task 1 variation") +
scale_x_continuous(breaks = unique(taskVarMean$n)) +
scale_y_continuous(breaks = seq(0, 3, 0.5)) +
scale_size_manual(values = c(2, 2, 2, 2, 2, 2, 2, 2, -1, -1, 2)) +
# Mean and SE portion of plot
geom_errorbar(data = taskVarMeans,
aes(x = n, ymin = NormVarMean - NormVarMeanSE, ymax = NormVarMean + NormVarMeanSE, colour = Source, width = 1.5),
position = position_dodge(width = 1)) +
geom_point(data = taskVarMeans,
aes(x = n, y = NormVarMean, colour = Source, size = as.factor(n)),
position = position_dodge(width = 1)) +
geom_line(data = taskVarMeans,
aes(x = n, y = NormVarMean, colour = Source),
position = position_dodge(width = 1)) +
scale_fill_manual(values = compPalette) +
scale_colour_manual(values = compPalette) +
theme(legend.position = "none",
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 6),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, space = "free", scale = "free")
gg_mean <- ggplot() +
geom_hline(data = taskVarMean,
aes(yintercept = 1),
colour = "grey30") +
geom_point(data = taskVarMean,
aes(x = n, y = NormMean, colour = Source),
size = 0.5,
alpha = 0.4,
position = position_dodge(width = 1)) +
theme_classic() +
xlab("Group Size") +
ylab("Relative task 1 frequency") +
scale_x_continuous(breaks = unique(taskVarMean$n)) +
scale_y_continuous(breaks = seq(0, 1.5, 0.05)) +
scale_size_manual(values = c(2, 2, 2, 2, 2, 2, 2, 2, -1, -1, 2)) +
# Mean and SE portion of plot
geom_errorbar(data = taskVarMeans,
aes(x = n, ymin = NormMean - NormMeanSE, ymax = NormMean + NormMeanSE, colour = Source, width = 1.5),
position = position_dodge(width = 1)) +
geom_point(data = taskVarMeans,
aes(x = n, y = NormMean, colour = Source, size = as.factor(n)),
position = position_dodge(width = 1)) +
geom_line(data = taskVarMeans,
aes(x = n, y = NormMean, colour = Source),
position = position_dodge(width = 1)) +
scale_fill_manual(values = compPalette) +
scale_colour_manual(values = compPalette) +
theme(legend.position = "none",
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 6),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, space = "free", scale = "free")
# MultiPlot
png(filename = paste0("output/_ComprehnsivePlots/", filename, ".png"), width = 4, height = 4, units = "in", res = 800)
multiplot(gg_dist, gg_mean,  gg_corr, gg_varNorm, cols = 2)
dev.off()
gg_corr <- ggplot() +
geom_hline(data = taskCorrTot,
aes(yintercept = 0),
colour = "grey30") +
geom_point(data = taskCorrTot,
aes(x = n, y = TaskMean, fill = Source, colour = Source),
size = 0.5,
position = position_dodge(width = 1),
alpha = 0.4) +
theme_classic() +
labs(x = "Group size",
y = "Specialization") +
scale_x_continuous(breaks = unique(taskCorrTot$n)) +
scale_y_continuous(breaks = seq(-1, 1, 0.2)) +
scale_size_manual(values = c(2, 2, 2, 2, 2, 2, 2, -1, -1, 2)) +
scale_fill_manual(values = compPalette) +
scale_colour_manual(values = compPalette) +
theme(legend.position = "none",
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 6),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
# Mean and SE portion of plot
geom_errorbar(data = taskCorrMeans,
aes(x = n, ymin = SpecMean - SpecSE, ymax = SpecMean + SpecSE, colour = Source, width = 1.5),
position = position_dodge(width = 1)) +
geom_point(data = taskCorrMeans,
aes(x = n, y = SpecMean, colour = Source, fill = Source, size = as.factor(n)),
position = position_dodge(width = 1)) +
geom_line(data = taskCorrMeans,
aes(x = n, y = SpecMean,  colour = Source),
position = position_dodge(width = 1)) +
facet_grid(. ~ mask, scales = "free", space = "free")
gg_mean <- ggplot() +
geom_hline(data = taskVarMean,
aes(yintercept = 1),
colour = "grey30") +
geom_point(data = taskVarMean,
aes(x = n, y = NormMean, colour = Source),
size = 0.5,
alpha = 0.4,
position = position_dodge(width = 1)) +
theme_classic() +
xlab("Group size") +
ylab("Relative task 1 frequency") +
scale_x_continuous(breaks = unique(taskVarMean$n)) +
scale_y_continuous(breaks = seq(0, 1.5, 0.05)) +
scale_size_manual(values = c(2, 2, 2, 2, 2, 2, 2, 2, -1, -1, 2)) +
# Mean and SE portion of plot
geom_errorbar(data = taskVarMeans,
aes(x = n, ymin = NormMean - NormMeanSE, ymax = NormMean + NormMeanSE, colour = Source, width = 1.5),
position = position_dodge(width = 1)) +
geom_point(data = taskVarMeans,
aes(x = n, y = NormMean, colour = Source, size = as.factor(n)),
position = position_dodge(width = 1)) +
geom_line(data = taskVarMeans,
aes(x = n, y = NormMean, colour = Source),
position = position_dodge(width = 1)) +
scale_fill_manual(values = compPalette) +
scale_colour_manual(values = compPalette) +
theme(legend.position = "none",
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 6),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, space = "free", scale = "free")
gg_varNorm <- ggplot() +
geom_hline(data = taskVarMean,
aes(yintercept = 1),
colour = "grey30") +
geom_point(data = taskVarMean,
aes(x = n, y = NormVarMean, colour = Source),
size = 0.8,
alpha = 0.4,
position = position_dodge(width = 1)) +
theme_classic() +
xlab("Group size") +
ylab("Relative task 1 variation") +
scale_x_continuous(breaks = unique(taskVarMean$n)) +
scale_y_continuous(breaks = seq(0, 3, 0.5)) +
scale_size_manual(values = c(2, 2, 2, 2, 2, 2, 2, 2, -1, -1, 2)) +
# Mean and SE portion of plot
geom_errorbar(data = taskVarMeans,
aes(x = n, ymin = NormVarMean - NormVarMeanSE, ymax = NormVarMean + NormVarMeanSE, colour = Source, width = 1.5),
position = position_dodge(width = 1)) +
geom_point(data = taskVarMeans,
aes(x = n, y = NormVarMean, colour = Source, size = as.factor(n)),
position = position_dodge(width = 1)) +
geom_line(data = taskVarMeans,
aes(x = n, y = NormVarMean, colour = Source),
position = position_dodge(width = 1)) +
scale_fill_manual(values = compPalette) +
scale_colour_manual(values = compPalette) +
theme(legend.position = "none",
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 6),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
strip.text = element_blank(),
strip.background = element_blank(),
panel.spacing = unit(0.25, "cm")) +
facet_grid(. ~ mask, space = "free", scale = "free")
# MultiPlot
png(filename = paste0("output/_ComprehnsivePlots/", filename, ".png"), width = 4, height = 4, units = "in", res = 800)
multiplot(gg_dist, gg_mean,  gg_corr, gg_varNorm, cols = 2)
dev.off()
