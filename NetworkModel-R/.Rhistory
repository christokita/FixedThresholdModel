axis.text.x = element_text(size = 8, margin = margin(6, 5, -2, 5), color = "black"),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
axis.ticks.length = unit(-0.1, "cm"),
# aspect.ratio = 1
)
gg_noTask
ggsave(filename = "output/FitnessPlots/AvgTaskNeglect_poster.png", height = 3, width = 1.75, dpi = 600)
ggsave(filename = "output/FitnessPlots/AvgTaskNeglect_poster.png", height = 3, width = 1.9, dpi = 600)
gg_specPerfNorm
ggsave(filename = "output/FitnessPlots/TaskNeglectVsSpecializationWithinGroups_poster.png", height = 3, width = 1.9, dpi = 600)
ggsave(filename = "output/FitnessPlots/TaskNeglectVsSpecializationWithinGroups_poster.png", height = 3, width = 1.75, dpi = 600)
gg_noTask
ggsave(filename = "output/FitnessPlots/AvgTaskNeglect_poster.png", height = 3, width = 1.75, dpi = 600)
# Unlist
stims <- unlist(groups_stim, recursive = FALSE)
stims <- do.call("rbind", stims)
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.2) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 5000),
labels = comma) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"))
# Select out example colonies
stimSet <- stims %>%
filter(n %in% c(2)) %>%
filter(replicate == 1) %>%
group_by(n) %>%
mutate(timestep = 0:(length(n)-1))
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.2) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 5000),
labels = comma) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"))
gg_stimEx2
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.2) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 100),
limits = c(0, 300),
labels = comma) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"))
gg_stimEx2
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.2) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 100),
limits = c(0, 500),
labels = comma) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"))
gg_stimEx2
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.2) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 100),
limits = c(0, 1000),
labels = comma) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"))
gg_stimEx2
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.2) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 100),
limits = c(0, 500),
labels = comma) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"))
gg_stimEx2
gg_stimEx2
# Select out example colonies
stimSet <- stims %>%
filter(n %in% c(2)) %>%
filter(replicate == 2) %>%
group_by(n) %>%
mutate(timestep = 0:(length(n)-1))
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.2) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 100),
limits = c(0, 500),
labels = comma) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"))
gg_stimEx2
# Select out example colonies
stimSet <- stims %>%
filter(n %in% c(2)) %>%
filter(replicate == 3) %>%
group_by(n) %>%
mutate(timestep = 0:(length(n)-1))
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.2) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 100),
limits = c(0, 500),
labels = comma) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"))
gg_stimEx2
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.2) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 100),
limits = c(0, 500),
labels = comma) +
scale_y_continuous(limits = c(0, 16),
breaks = seq(0, 15, 5),
expand = c(0,0))
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.2) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 100),
limits = c(0, 500),
labels = comma) +
scale_y_continuous(limits = c(0, 16),
breaks = seq(0, 15, 5),
expand = c(0,0)) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"))
gg_stimEx2
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.2) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 300),
limits = c(0, 600),
labels = comma) +
scale_y_continuous(limits = c(0, 16),
breaks = seq(0, 15, 5),
expand = c(0,0)) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"),
aspect.ratio = 1)
gg_stimEx2
ggsave(filename = "output/FitnessPlots/StimExample2_poster.png", width = 1, height = 1, units = "in", dpi = 600)
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.2) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 300),
limits = c(0, 600),
labels = comma) +
scale_y_continuous(limits = c(0, 16),
breaks = seq(0, 15, 15),
expand = c(0,0)) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"),
aspect.ratio = 1)
gg_stimEx2
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.2) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 500),
limits = c(0, 500),
labels = comma) +
scale_y_continuous(limits = c(0, 16),
breaks = seq(0, 15, 15),
expand = c(0,0)) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_blank(),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"),
aspect.ratio = 1)
gg_stimEx2
ggsave(filename = "output/FitnessPlots/StimExample2_poster.png", width = 1, height = 1, units = "in", dpi = 600)
ggsave(filename = "output/FitnessPlots/StimExample2_poster.png", width = 1.5, height = 1.5, units = "in", dpi = 600)
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.5) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 500),
limits = c(0, 500),
labels = comma) +
scale_y_continuous(limits = c(0, 16),
breaks = seq(0, 15, 15),
expand = c(0,0)) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_blank(),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"),
aspect.ratio = 1)
gg_stimEx2
ggsave(filename = "output/FitnessPlots/StimExample2_poster.png", width = 1.5, height = 1.5, units = "in", dpi = 600)
#### 1 Time steps ####
# Normalize and Summarise by "day" (i.e., time window) and calculate difference
stimFluct <- stims %>%
select(-delta1, -delta2) %>%
mutate(Set = paste0(n, "-", replicate)) %>%
group_by(Set) %>%
mutate(t = 0:(length(Set)-1)) %>%
mutate(Window = t %/% 1) %>%
filter(t != 0) %>%
group_by(n, Set, Window) %>%
summarise(s1 = mean(s1),
s2 = mean(s2)) %>%
mutate(s1Diff = abs(s1 - lag(s1)),
s2Diff = abs(s2 - lag(s2)),
BeginSet = !duplicated(Set))
# Make sure first diff row of each new set is NA
sets <- which(stimFluct$BeginSet == TRUE)
stimFluct$s1Diff[sets] <- NA
stimFluct$s2Diff[sets] <- NA
# Summarise by colony/set
stimFluct <- stimFluct %>%
group_by(n, Set) %>%
summarise(s1Fluct = mean(s1Diff, na.rm = TRUE),
s2Fluct = mean(s2Diff, na.rm = TRUE)) %>%
mutate(GroupSizeFactor = factor(n, levels = sort(unique(n))))
# Summarise by n
stimSumFluct <- stimFluct %>%
group_by(n, GroupSizeFactor) %>%
summarise(s1FluctMean = mean(s1Fluct, na.rm = TRUE),
s1FluctSE = sd(s1Fluct, na.rm = TRUE) / sqrt(length(s1Fluct)),
s2FluctMean = mean(s2Fluct, na.rm = TRUE),
s2FluctSE = sd(s2Fluct, na.rm = TRUE) / sqrt(length(s2Fluct)))
stimSumFluct <- as.data.frame(stimSumFluct)
stimSumFluct <- stimSumFluct %>%
mutate(GroupSizeFactor = factor(GroupSizeFactor, levels = sort(unique(n))))
# Plot
gg_stimfluct <- ggplot() +
geom_point(data = stimFluct,
aes(x = n, y = s1Fluct),
fill = "grey50",
colour = "grey50",
position = position_jitter(width = 0.1),
size = 0.7,
alpha = 0.4,
stroke = 0) +
# geom_line(data = stimSumFluct,
#           aes(x = n, y = s1FluctMean),
#           size = 0.3) +���
theme_classic() +
labs(x = "Group size",
y = "Stimulus fluctuation") +
scale_x_continuous(breaks = unique(stimFluct$n)) +
scale_y_continuous(breaks = seq(0, 2, 0.2),
limits = c(0, 0.85),
expand = c(0, 0)) +
theme(legend.position = "none") +
# Mean and SE portion of plot
geom_errorbar(data = stimSumFluct,
aes(x = n,
ymin = s1FluctMean - s1FluctSE,
ymax = s1FluctMean + s1FluctSE),
colour = "black",
size = 0.25) +
geom_point(data = stimSumFluct,
aes(x = n, y = s1FluctMean),
colour = "black",
size = 1.5) +
theme(legend.position = "none",
legend.justification = c(1, 1),
legend.title = element_blank(),
legend.key.height = unit(0.3, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.margin =  margin(t = 0, r = 0, b = 0, l = -0.2, "cm"),
legend.text = element_text(size = 6),
legend.text.align = 0,
# legend.box.background = element_rect(),
axis.text.y = element_text(size = 8, margin = margin(5, 6, 5, -2), color = "black"),
axis.text.x = element_text(size = 8, margin = margin(6, 5, -2, 5), color = "black"),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
axis.ticks.length = unit(-0.1, "cm"))
gg_stimfluct
# Plot
gg_stimfluct <- ggplot() +
geom_point(data = stimFluct,
aes(x = n, y = s1Fluct),
fill = "grey50",
colour = "grey50",
position = position_jitter(width = 0.1),
size = 0.7,
alpha = 0.4,
stroke = 0) +
# geom_line(data = stimSumFluct,
#           aes(x = n, y = s1FluctMean),
#           size = 0.3) +���
theme_classic() +
labs(x = "Group size",
y = "Stimulus fluctuation") +
scale_x_continuous(breaks = unique(neglectSum$n),
labels = c("1", "", "4", "", "8", "", "16")) +
scale_y_continuous(breaks = seq(0, 2, 0.2),
limits = c(0, 0.85),
expand = c(0, 0)) +
theme(legend.position = "none") +
# Mean and SE portion of plot
geom_errorbar(data = stimSumFluct,
aes(x = n,
ymin = s1FluctMean - s1FluctSE,
ymax = s1FluctMean + s1FluctSE),
colour = "black",
size = 0.25) +
geom_point(data = stimSumFluct,
aes(x = n, y = s1FluctMean),
colour = "black",
size = 1.5) +
theme(legend.position = "none",
legend.justification = c(1, 1),
legend.title = element_blank(),
legend.key.height = unit(0.3, "cm"),
legend.key.width= unit(0.4, "cm"),
legend.margin =  margin(t = 0, r = 0, b = 0, l = -0.2, "cm"),
legend.text = element_text(size = 6),
legend.text.align = 0,
# legend.box.background = element_rect(),
axis.text.y = element_text(size = 8, margin = margin(5, 6, 5, -2), color = "black"),
axis.text.x = element_text(size = 8, margin = margin(6, 5, -2, 5), color = "black"),
axis.title = element_text(size = 10, margin = margin(0, 0, 0, 0)),
axis.ticks.length = unit(-0.1, "cm"))
gg_stimfluct
ggsave(filename = "output/FitnessPlots/StimulusFluctuations_poster.png", height = 3, width = 1.75, dpi = 600)
ggsave(filename = "output/FitnessPlots/StimulusFluctuations_poster.png", height = 3, width = 2, dpi = 600)
# Select out example colonies
stimSet <- stims %>%
filter(n %in% c(16)) %>%
filter(replicate == 1) %>%
group_by(n) %>%
mutate(timestep = 0:(length(n)-1))
# Plot
gg_stimEx16 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.5) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 500),
limits = c(0, 500),
labels = comma) +
scale_y_continuous(limits = c(0, 16),
breaks = seq(0, 15, 15),
expand = c(0,0)) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_blank(),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"),
aspect.ratio = 1)
gg_stimEx16
# Plot
gg_stimEx16 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.5) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 250),
limits = c(0, 500),
labels = comma) +
scale_y_continuous(limits = c(0, 16),
breaks = seq(0, 15, 15),
expand = c(0,0)) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_blank(),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"),
aspect.ratio = 1)
gg_stimEx16
ggsave(filename = "output/FitnessPlots/StimExample16_poster.png", width = 1.5, height = 1.5, units = "in", dpi = 600)
# Select out example colonies
stimSet <- stims %>%
filter(n %in% c(2)) %>%
filter(replicate == 3) %>%
group_by(n) %>%
mutate(timestep = 0:(length(n)-1))
# Plot
gg_stimEx2 <- ggplot(data = stimSet, aes(x = timestep, y = s1)) +
geom_line(colour = "#4eb3d3",
size = 0.5) +
theme_classic() +
xlab("Timestep") +
ylab("Stimulus") +
scale_x_continuous(breaks = seq(0, 10000, 250),
limits = c(0, 500),
labels = comma) +
scale_y_continuous(limits = c(0, 16),
breaks = seq(0, 15, 15),
expand = c(0,0)) +
theme(plot.margin = margin(0.25, 0.4, 0.25, 0.25, "cm"),
axis.text = element_text(size = 8),
axis.title = element_blank(),
axis.ticks = element_line(size = 0.5),
strip.text = element_text(size = 7, face = "italic"),
strip.background = element_rect(fill = NA, colour = NA),
panel.spacing = unit(0.5, "cm"),
aspect.ratio = 1)
gg_stimEx2
ggsave(filename = "output/FitnessPlots/StimExample2_poster.png", width = 1.5, height = 1.5, units = "in", dpi = 600)
